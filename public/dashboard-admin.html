<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - Berkah Farm</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div id="navbar-container"></div>

    <div class="container">
        
        <div style="padding: 2rem 2rem 0 2rem;">
            <h2>Halo, Admin! üëã</h2>
            <p style="color: var(--text-gray);">Pantau operasional Berkah Farm hari ini.</p>
        </div>

        <div class="dashboard-grid">
            
            
            <div class="glass-card" style="background: linear-gradient(135deg, rgba(212, 252, 121, 0.2) 0%, rgba(30, 34, 45, 0.6) 100%); grid-row: span 2;">
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <h1 style="font-size: 3.5rem; color: var(--accent-green);">28¬∞C</h1>
                        <p style="color: var(--text-white);">Cerah Berawan</p>
                    </div>
                    <i class="fas fa-cloud-sun" style="font-size: 3rem; color: var(--accent-green);"></i>
                </div>
                <div style="margin-top: 2rem;">
                    <p class="card-title">Lokasi Kandang</p>
                    <h4>Bandung, Jawa Barat</h4>
                    <p style="font-size: 0.8rem; margin-top: 10px; color: var(--text-gray);">Kelembaban: 60% ‚Ä¢ Angin: 12km/h</p>
                </div>
            </div>

            <div class="glass-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <span class="card-title">Pesanan Baru (Pending)</span>
                    <i class="fas fa-bell" style="color: var(--accent-green);"></i>
                </div>
                <div class="card-value">5 Pesanan</div>
                <p style="font-size: 0.8rem; color: var(--text-gray); margin-top: 5px;">Perlu verifikasi pembayaran.</p>
                <a href="admin-pesanan.html" style="display: block; margin-top: 15px; font-size: 0.9rem;">Lihat Detail &rarr;</a>
            </div>

            <div class="glass-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <span class="card-title">Total Stok Hewan</span>
                    <i class="fas fa-cow" style="color: var(--accent-green);"></i>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid var(--card-border); padding-bottom: 5px;">
                    <span>üêê Kambing</span>
                    <span style="color: var(--accent-green);">45 Ekor</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>üêÑ Sapi</span>
                    <span style="color: var(--accent-green);">12 Ekor</span>
                </div>
                <a href="admin-stok.html" style="display: block; margin-top: 15px; font-size: 0.9rem;">Kelola Stok &rarr;</a>
            </div>

            <div class="glass-card" style="grid-column: span 2; min-height: 200px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                <i class="fas fa-chart-line" style="font-size: 3rem; color: var(--card-border); margin-bottom: 1rem;"></i>
                <p style="color: var(--text-gray);">Grafik Penjualan Bulan Ini</p>
                <h3 style="color: var(--accent-green);">Rp 125.000.000</h3>
            </div>

        </div>
    </div>
    <div class="glass-card" style="background: linear-gradient(135deg, rgba(231, 76, 60, 0.2) 0%, rgba(30, 34, 45, 0.6) 100%);">
    <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
        <span class="card-title">Stok Kritis</span>
        <i class="fas fa-exclamation-triangle" style="color: #e74c3c;"></i>
    </div>
    <div id="stok-kritis" style="font-size: 1.2rem; color: white;">Loading...</div>
    <p style="font-size: 0.8rem; color: var(--text-gray); margin-top: 5px;">Butuh perhatian segera</p>
    <a href="admin-stok.html" style="display: block; margin-top: 15px; font-size: 0.9rem; color: #e74c3c;">
        <i class="fas fa-arrow-right"></i> Cek Stok
    </a>
</div>

    <script src="js/navbar.js">
         async function loadStokKritis() {
        try {
            const response = await fetch('http://localhost:3000/api/hewan');
            const data = await response.json();
            
            const stokKritis = data.filter(h => h.stok > 0 && h.stok <= 3);
            
            if (stokKritis.length === 0) {
                document.getElementById('stok-kritis').innerHTML = 
                    '<span style="color: var(--accent-green);">Aman</span>';
                document.getElementById('stok-kritis').innerHTML += 
                    '<div style="font-size: 0.9rem; color: var(--text-gray); margin-top: 5px;">Semua stok aman</div>';
            } else {
                const list = stokKritis.map(h => 
                    `${h.jenis_hewan} (${h.stok})`
                ).join(', ');
                
                document.getElementById('stok-kritis').innerHTML = 
                    `<span style="color: #e74c3c; font-weight: bold;">${stokKritis.length} item</span>`;
                document.getElementById('stok-kritis').innerHTML += 
                    `<div style="font-size: 0.9rem; color: #e74c3c; margin-top: 5px;">${list}</div>`;
            }
        } catch (error) {
            console.error('Error load stok:', error);
            document.getElementById('stok-kritis').innerText = 'Error';
        }
    }
    
    // Panggil fungsi
    loadStokKritis();
    </script>
</body>
</html>